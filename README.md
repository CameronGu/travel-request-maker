# Travel-Request Platform Rebuild

This repo contains the **Travel-Request Platform Rebuild** — a Next.js and Supabase-based application to manage enterprise travel requests.  
It consolidates all previous systems into a modern, maintainable, and well-documented platform.

---

## Purpose

- Simplify travel request workflows for **coordinators, bookers, billing staff, and client admins**.
- Use a **dynamic form engine** to reduce redundancy and support complex service needs.
- Ensure **data security** via JWE links and Supabase-based data handling.
- Serve as the single source of truth for travel request lifecycle.

---

## Structure

- **`docs/latest/`**:  
  The canonical location for all project specs.  
  - `prd.md` – Product Requirements Document  
  - `form-spec.md` – Form fields and validation logic  
  - `roles-permissions.md` – Access control model  
  - `legacy-mapping.md` – Legacy system to new mapping  
  - `admin-ui-wireframes.md` – Wireframes and UI hints  
  - `jwe-link-spec.md` – Secure link sharing format

- **`src/`**:  
  The Next.js app, including React components, Supabase hooks, and UI logic.

- **`.env.example` / `.env.local`**:  
  Environment variables for local development.

- **`tasks.json`**:  
  Tasks file generated by **TaskMaster AI** — always based on current PRD + supporting specs.

---

## Setup & Dev Workflow

1️⃣ **Install dependencies**  
```bash
npm install
````

2️⃣ **Create local environment**

```bash
cp .env.example .env.local
```

Fill in with Supabase project credentials:

```
NEXT_PUBLIC_SUPABASE_URL=https://your-supabase-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
```

3️⃣ **Run locally**

```bash
npm run dev
```

4️⃣ **(Re)generate tasks for Cursor**

```bash
npm run parse-prd
```

---

## Branch & Release Strategy

* **Active dev branch**: `next-migration`
* **Stable branch**: `main` (protected, only merge via PRs)

No direct pushes to `main` — enforced via GitHub rules (public repos only).

---

## Notes for Me

* **TaskMaster parse command:**

  ```bash
  task-master parse-prd prd.md -k docs/latest/ -o tasks.json
  ```

  (wrapped as `npm run parse-prd`)

* **Supabase & Vercel setup**:

  * Supabase: project created and linked
  * Vercel: linked, but can stay local until MVP ready

* **Environment variables checklist:**

  * `NEXT_PUBLIC_SUPABASE_URL`
  * `NEXT_PUBLIC_SUPABASE_ANON_KEY`
  * (Optional) `NEXT_PUBLIC_JWE_KEY` for link encryption, if using

---

## Lint & Tests

* **Lint:**

  ```bash
  npm run lint
  ```

* **Tests:**

  ```bash
  npm run test
  ```

---

## Next Steps (MVP)

* Complete DynamicForm Engine
* Finish admin views (based on `admin-ui-wireframes.md`)
* Implement Supabase role logic from `roles-permissions.md`
* Integrate secure JWE links for link-based approval flows

---

## Misc

* **Audience:** Me / internal dev team only
* **Docs:** stored in `docs/latest/`
* **AI tools:** TaskMaster + Cursor ready to generate + execute tasks

---